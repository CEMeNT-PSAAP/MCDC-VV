import mcdc
import numpy as np


##############################
#__________Materials__________
##############################

# Material Name: Core region
# Depletable
m1 = mcdc.material(nuclides=[
	['Pu238',1.6938e-09],
	['Pu239',0.00106299],
	['Pu240',5.03037e-05],
	['Pu242',1.15592e-07],
	['Am241',2.98613e-06],
	['Cr50',0.0004276344655],
	['Cr52',0.0082465050011],
	['Cr53',0.0009350874699],
	['Cr54',0.00023276306350000005],
	['Al27',0.000111659],
	['Mn55',0.000805254],
	['Co59',3.71924e-06],
	['Ni58',0.00278113198032],
	['Ni60',0.00107128705968],
	['Ni61',4.6568106719999996e-05],
	['Ni62',0.0001484795016],
	['Ni64',3.781335168e-05],
	['C0',0.0258213],
	['Cu63',7.00012365e-05],
	['Cu65',3.12297635e-05],
	['Fe54',0.002060987915],
	['Fe56',0.032353102678],
	['Fe57',0.000747174233],
	['Fe58',9.9435174e-05],
	['Mo100',7.237765248e-06],
	['Mo92',1.0881160008000002e-05],
	['Mo94',6.824030103999999e-06],
	['Mo95',1.1790337416000002e-05],
	['Mo96',1.2384571015999997e-05],
	['Mo97',7.117432944000001e-06],
	['Mo98',1.8043903264e-05],
	['Si28',0.0002578529724536],
	['Si29',1.3093038233199999e-05],
	['Si30',8.6309893132e-06]])
# Material Name: Axial stainless steel
m2 = mcdc.material(nuclides=[
	['Cr50',0.0006833685650000001],
	['Cr52',0.013178082553],
	['Cr53',0.001494288777],
	['Cr54',0.000371960105],
	['Mn55',0.00156081],
	['Co59',3.7358199999999996e-06],
	['Ni58',0.00472900951233],
	['Ni60',0.0018216059976699998],
	['Ni61',7.918395143e-05],
	['Ni62',0.00025247308665],
	['Ni64',6.429745192e-05],
	['C0',0.000235948],
	['Cu63',2.0614652250000002e-05],
	['Cu65',9.19684775e-06],
	['Fe54',0.0032452667450000006],
	['Fe56',0.050943747633999996],
	['Fe57',0.001176513299],
	['Fe58',0.000156572322],
	['Mo100',1.48225728e-06],
	['Mo92',2.22840588e-06],
	['Mo94',1.3975264400000002e-06],
	['Mo95',2.41460076e-06],
	['Mo96',2.53629676e-06],
	['Mo97',1.45761384e-06],
	['Mo98',3.69529904e-06],
	['Si28',0.000872022401432],
	['Si29',4.4278809484e-05],
	['Si30',2.9188789084e-05]])
# Material Name: Radial stainless steel
m3 = mcdc.material(nuclides=[
	['Cr50',0.0006790626700000001],
	['Cr52',0.013095047654],
	['Cr53',0.001484873286],
	['Cr54',0.0003696163899999999],
	['Mn55',0.00142057],
	['Co59',3.77932e-06],
	['Ni58',0.0046184049729],
	['Ni60',0.0017790013271],
	['Ni61',7.73319559e-05],
	['Ni62',0.00024656811450000005],
	['Ni64',6.27936296e-05],
	['C0',0.00023710599999999998],
	['Cu63',3.4855195800000004e-05],
	['Cu65',1.55500042e-05],
	['Fe54',0.0032262295800000004],
	['Fe56',0.050644904856],
	['Fe57',0.001169611716],
	['Fe58',0.000155653848],
	['Mo100',4.521440112e-06],
	['Mo92',6.7974729269999994e-06],
	['Mo94',4.262979301e-06],
	['Mo95',7.365437079000001e-06],
	['Mo96',7.736655479e-06],
	['Mo97',4.446268386e-06],
	['Mo98',1.1272046716e-05],
	['Si28',0.000796274165248],
	['Si29',4.0432530176e-05],
	['Si30',2.6653304576e-05]])
# Material Name: Iron radial reflector
m4 = mcdc.material(nuclides=[
	['Cr50',7.9408351e-05],
	['Cr52',0.0015313110062000002],
	['Cr53',0.00017363837579999997],
	['Cr54',4.3222267e-05],
	['Mn55',0.00055035],
	['Co59',3.77222e-06],
	['Ni58',0.0005183613435149999],
	['Ni60',0.000199671861485],
	['Ni61',8.679597565e-06],
	['Ni62',2.7674355075000005e-05],
	['Ni64',7.047842359999999e-06],
	['C0',0.00042731499999999994],
	['Cu63',2.0085101550000002e-05],
	['Cu65',8.96059845e-06],
	['Fe54',0.00448037954],
	['Fe56',0.070332377128],
	['Fe57',0.0016242813080000003],
	['Fe58',0.000216162024],
	['Mo100',1.42491384e-06],
	['Mo92',2.142196515e-06],
	['Mo94',1.343460945e-06],
	['Mo95',2.3211881550000002e-06],
	['Mo96',2.438176155e-06],
	['Mo97',1.40122377e-06],
	['Mo98',3.55234062e-06],
	['Si28',0.0001338695359264],
	['Si29',6.7975130768e-06],
	['Si30',4.4809509968e-06]])
# Material Name: Empty matrix
m5 = mcdc.material(nuclides=[
	['Cr50',5.1586881500000005e-05],
	['Cr52',0.0009948016603],
	['Cr53',0.00011280252269999999],
	['Cr54',2.80789355e-05],
	['Mn55',0.000105699],
	['Ni58',0.000326455285491],
	['Ni60',0.000125749991509],
	['Ni61',5.466265061e-06],
	['Ni62',1.7428844955e-05],
	['Ni64',4.438612984000001e-06],
	['C0',1.87078e-05],
	['Cu63',1.188335835e-05],
	['Cu65',5.301541649999999e-06],
	['Fe54',0.0002497235335],
	['Fe56',0.0039201254222],
	['Fe57',9.05327917e-05],
	['Fe58',1.20482526e-05],
	['Mo100',8.026103567999999e-07],
	['Mo92',1.2066337353000001e-06],
	['Mo94',7.567304339e-07],
	['Mo95',1.3074542481e-06],
	['Mo96',1.3733500081e-06],
	['Mo97',7.892664654000001e-07],
	['Mo98',2.0009247524e-06],
	['Si28',6.287730765095999e-05],
	['Si29',3.1927302805199995e-06],
	['Si30',2.10466206852e-06]])
mvoid = mcdc.material(nuclides=[['N14',1e-10]])
##############################
#__________Geometry__________
##############################

# Surface(s)
s1 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=41.93313, bc='interface')
s2 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=86.88175, bc='interface')
s3 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=104.17047, bc='interface')
s4 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=115.32402, bc='vacuum')
s10 = mcdc.surface('plane-z', z=-121.92, bc='vacuum')
s11 = mcdc.surface('plane-z', z=-92.08002, bc='interface')
s12 = mcdc.surface('plane-z', z=-38.17874, bc='interface')
s13 = mcdc.surface('plane-z', z=38.17874, bc='interface')
s14 = mcdc.surface('plane-z', z=92.08002, bc='interface')
s15 = mcdc.surface('plane-z', z=121.92, bc='vacuum')

# Material Cell(s)
c1 = mcdc.cell(-s4 & +s10 & -s11, fill=m5)
c2 = mcdc.cell(-s1 & +s11 & -s12, fill=m2)
c3 = mcdc.cell(-s1 & +s12 & -s13, fill=m1)
c4 = mcdc.cell(-s1 & +s13 & -s14, fill=m2)
c5 = mcdc.cell(+s1 & -s2 & +s11 & -s14, fill=m3)
c6 = mcdc.cell(+s2 & -s3 & +s11 & -s14, fill=m4)
c7 = mcdc.cell(+s3 & -s4 & +s11 & -s14, fill=m5)
c8 = mcdc.cell(-s4 & +s14 & -s15, fill=m5)
# Root Universe Cells List:
u0_cells = []
# Material Universe(s)

##############################
#__________Settings__________
##############################

# Simulation Parameters
mcdc.eigenmode(N_inactive=20, N_active=180)
mcdc.setting(N_particle=10000)

# Source Parameters
# Particle: neutron
# Space Type: box
mcdc.source(x=[-42.0,42.0], y=[-42.0,42.0], z=[0.0,38.2], prob=1.0)

mcdc.run()

