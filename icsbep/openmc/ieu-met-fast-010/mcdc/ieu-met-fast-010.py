import mcdc
import numpy as np


##############################
#__________Materials__________
##############################

# Material Name: Empty matrix above and below reflector
m1 = mcdc.material(nuclides=[
	['Cr50',5.166596050000001e-05],
	['Cr52',0.0009963266201],
	['Cr53',0.00011297544090000002],
	['Cr54',2.8121978500000004e-05],
	['Ni58',0.000326888254575],
	['Ni60',0.000125916770425],
	['Ni61',5.473514825e-06],
	['Ni62',1.7451960375e-05],
	['Ni64',4.4444998000000005e-06],
	['Fe54',0.000250115733],
	['Fe56',0.0039262821156],
	['Fe57',9.06749766e-05],
	['Fe58',1.2067174799999999e-05],
	['C0',1.87415e-05],
	['Mo100',8.045162832e-07],
	['Mo92',1.2094990797e-06],
	['Mo94',7.585274110999998e-07],
	['Mo95',1.3105590069000002e-06],
	['Mo96',1.3766112468999998e-06],
	['Mo97',7.911407046e-07],
	['Mo98',2.0056762676e-06],
	['Mn55',0.000105905],
	['Cu63',1.1915858850000001e-05],
	['Cu65',5.31604115e-06],
	['Si28',6.30025555564e-05],
	['Si29',3.1990900118e-06],
	['Si30',2.1088544318e-06]])
# Material Name: Empty matrix surrounding radial reflector
m2 = mcdc.material(nuclides=[
	['Cr50',5.12523165e-05],
	['Cr52',0.0009883499073],
	['Cr53',0.0001120709457],
	['Cr54',2.7896830499999997e-05],
	['Ni58',0.000324270017001],
	['Ni60',0.000124908229999],
	['Ni61',5.429674270999999e-06],
	['Ni62',1.7312177505e-05],
	['Ni64',4.4089012240000005e-06],
	['Fe54',0.00024811323600000003],
	['Fe56',0.003894847195200001],
	['Fe57',8.994900720000001e-05],
	['Fe58',1.19705616e-05],
	['C0',1.85933e-05],
	['Mo100',7.981076543999999e-07],
	['Mo92',1.1998644324000002e-06],
	['Mo94',7.524851211999999e-07],
	['Mo95',1.3001193348e-06],
	['Mo96',1.3656454147999998e-06],
	['Mo97',7.848386232000001e-07],
	['Mo98',1.9896994192e-06],
	['Mn55',0.000105057],
	['Cu63',1.18207776e-05],
	['Cu65',5.2736224e-06],
	['Si28',6.24975980584e-05],
	['Si29',3.1734497107999994e-06],
	['Si30',2.0919522308e-06]])
# Material Name: DU radial reflector
# Depletable
m3 = mcdc.material(nuclides=[
	['U235',8.56868e-05],
	['U238',0.0383747],
	['Cr50',7.3648619e-05],
	['Cr52',0.0014202403078],
	['Cr53',0.00016104385019999998],
	['Cr54',4.0087223e-05],
	['Ni58',0.00046721312623799994],
	['Ni60',0.00017996965976199998],
	['Ni61',7.823156497999999e-06],
	['Ni62',2.494364619e-05],
	['Ni64',6.352411312e-06],
	['Fe54',0.00035844111800000005],
	['Fe56',0.005626758997600001],
	['Fe57',0.0001299464036],
	['Fe58',1.72934808e-05],
	['C0',3.77935e-05],
	['Mo100',1.049146224e-06],
	['Mo92',1.5772724790000004e-06],
	['Mo94',9.89173477e-07],
	['Mo95',1.7090617830000003e-06],
	['Mo96',1.7951985830000002e-06],
	['Mo97',1.031703522e-06],
	['Mo98',2.6155439320000003e-06],
	['Mn55',0.000146803],
	['Cu63',1.4993103e-05],
	['Cu65',6.688897e-06],
	['H1',2.5376347272078e-06],
	['H2',3.952727922e-10],
	['Si28',7.098697118368e-05],
	['Si29',3.60451585616e-06],
	['Si30',2.37611296016e-06],
	['Cl35',3.32951004738e-06],
	['Cl37',1.0650299526200002e-06],
	['F19',1.30132e-05]])
# Material Name: Lower DU axial reflector
# Depletable
m4 = mcdc.material(nuclides=[
	['U235',8.24312e-05],
	['U238',0.0369113],
	['Cr50',7.50064315e-05],
	['Cr52',0.0014464243703],
	['Cr53',0.0001640129127],
	['Cr54',4.08262855e-05],
	['Ni58',0.0004791497298839999],
	['Ni60',0.000184567618116],
	['Ni61',8.023026564e-06],
	['Ni62',2.5580919420000006e-05],
	['Ni64',6.514706016e-06],
	['Fe54',0.0003662517915],
	['Fe56',0.0057493698678],
	['Fe57',0.0001327780233],
	['Fe58',1.7670317400000002e-05],
	['Al27',0.00041674699999999997],
	['C0',3.97675e-05],
	['Mo100',1.093335264e-06],
	['Mo92',1.6437056940000001e-06],
	['Mo94',1.030836522e-06],
	['Mo95',1.7810458380000002e-06],
	['Mo96',1.8708106379999998e-06],
	['Mo97',1.075157892e-06],
	['Mo98',2.725708152e-06],
	['Mn55',0.000146859],
	['Cu63',1.476608355e-05],
	['Cu65',6.5876164499999996e-06],
	['H1',2.8173311605002e-06],
	['H2',4.3883949980000003e-10],
	['Si28',7.666472251416e-05],
	['Si29',3.89281586892e-06],
	['Si30',2.56616161692e-06],
	['Cl35',3.69063491346e-06],
	['Cl37',1.18054508654e-06],
	['F19',1.44249e-05]])
# Material Name: Upper DU axial reflector
# Depletable
m5 = mcdc.material(nuclides=[
	['U235',8.31425e-05],
	['U238',0.0372293],
	['Cr50',7.50064315e-05],
	['Cr52',0.0014464243703],
	['Cr53',0.0001640129127],
	['Cr54',4.08262855e-05],
	['Ni58',0.000479149729884],
	['Ni60',0.000184567618116],
	['Ni61',8.023026564e-06],
	['Ni62',2.5580919420000002e-05],
	['Ni64',6.514706016e-06],
	['Fe54',0.0003662804320000001],
	['Fe56',0.0057498194624],
	['Fe57',0.0001327884064],
	['Fe58',1.76716992e-05],
	['Al27',0.000416747],
	['C0',3.99149e-05],
	['Mo100',1.093335264e-06],
	['Mo92',1.643705694e-06],
	['Mo94',1.030836522e-06],
	['Mo95',1.7810458380000002e-06],
	['Mo96',1.870810638e-06],
	['Mo97',1.075157892e-06],
	['Mo98',2.725708152e-06],
	['Mn55',0.000146859],
	['Cu63',1.476608355e-05],
	['Cu65',6.5876164499999996e-06],
	['H1',2.8538254759902e-06],
	['H2',4.4452400979999994e-10],
	['Si28',7.666472251416e-05],
	['Si29',3.89281586892e-06],
	['Si30',2.56616161692e-06],
	['Cl35',3.7381848391799994e-06],
	['Cl37',1.19575516082e-06],
	['F19',1.46107e-05]])
# Material Name: Core 1
# Depletable
m6 = mcdc.material(nuclides=[
	['U235',0.0034854300000000003],
	['U238',0.0352634],
	['Cr50',8.08461115e-05],
	['Cr52',0.0015590367863],
	['Cr53',0.0001767822567],
	['Cr54',4.4004845500000004e-05],
	['Ni58',0.000509932061757],
	['Ni60',0.00019642491724299998],
	['Ni61',8.538455147e-06],
	['Ni62',2.7224331285e-05],
	['Ni64',6.933234568e-06],
	['Fe54',0.00038909463599999994],
	['Fe56',0.0061079536751999985],
	['Fe57',0.0001410592872],
	['Fe58',1.87724016e-05],
	['C0',9.6299e-05],
	['Mo100',1.152978288e-06],
	['Mo92',1.733372223e-06],
	['Mo94',1.087070149e-06],
	['Mo95',1.878204471e-06],
	['Mo96',1.9728660709999996e-06],
	['Mo97',1.133809314e-06],
	['Mo98',2.8743994839999998e-06],
	['Mn55',0.000163509],
	['Cu63',1.651530195e-05],
	['Cu65',7.36799805e-06],
	['H1',1.945496961108e-05],
	['H2',3.0303889199999992e-09],
	['Si28',6.603654310968001e-05],
	['Si29',3.35314724316e-06],
	['Si30',2.21040964716e-06],
	['Cl35',2.5267982038199997e-05],
	['Cl37',8.0826179618e-06],
	['F19',9.9122e-05]])
# Material Name: Core 2
# Depletable
m7 = mcdc.material(nuclides=[
	['U235',0.0034766599999999995],
	['U238',0.0353869],
	['Cr50',8.143312100000001e-05],
	['Cr52',0.0015703566802],
	['Cr53',0.0001780658418],
	['Cr54',4.4324357e-05],
	['Ni58',0.000513745048926],
	['Ni60',0.000197893673074],
	['Ni61',8.602300946e-06],
	['Ni62',2.7427899630000002e-05],
	['Ni64',6.985077424000001e-06],
	['Fe54',0.00039205454399999996],
	['Fe56',0.006154417900799999],
	['Fe57',0.0001421323488],
	['Fe58',1.89152064e-05],
	['C0',9.64166e-05],
	['Mo100',1.167321456e-06],
	['Mo92',1.7549355510000002e-06],
	['Mo94',1.100593413e-06],
	['Mo95',1.9015695270000002e-06],
	['Mo96',1.9974087269999997e-06],
	['Mo97',1.147914018e-06],
	['Mo98',2.910157308e-06],
	['Mn55',0.000164823],
	['Cu63',1.675705035e-05],
	['Cu65',7.475849650000001e-06],
	['H1',1.9446770888148e-05],
	['H2',3.029111852e-09],
	['Si28',6.843792728784e-05],
	['Si29',3.47508268008e-06],
	['Si30',2.2907900320799997e-06],
	['Cl35',2.5357384384199998e-05],
	['Cl37',8.1112156158e-06],
	['F19',9.947259999999999e-05]])
# Material Name: Core 3
# Depletable
m8 = mcdc.material(nuclides=[
	['U235',0.0034854300000000003],
	['U238',0.0352634],
	['Cr50',8.08461115e-05],
	['Cr52',0.0015590367863],
	['Cr53',0.0001767822567],
	['Cr54',4.4004845500000004e-05],
	['Ni58',0.000509932061757],
	['Ni60',0.00019642491724299998],
	['Ni61',8.538455147e-06],
	['Ni62',2.7224331285000004e-05],
	['Ni64',6.933234568e-06],
	['Fe54',0.000389094636],
	['Fe56',0.006107953675199999],
	['Fe57',0.0001410592872],
	['Fe58',1.87724016e-05],
	['C0',9.62606e-05],
	['Mo100',1.152978288e-06],
	['Mo92',1.733372223e-06],
	['Mo94',1.087070149e-06],
	['Mo95',1.8782044709999999e-06],
	['Mo96',1.9728660709999996e-06],
	['Mo97',1.133809314e-06],
	['Mo98',2.8743994839999998e-06],
	['Mn55',0.000163509],
	['Cu63',1.651530195e-05],
	['Cu65',7.36799805e-06],
	['H1',1.9444071308646e-05],
	['H2',3.0286913539999996e-09],
	['Si28',6.603654310968001e-05],
	['Si29',3.35314724316e-06],
	['Si30',2.21040964716e-06],
	['Cl35',2.5253435215799997e-05],
	['Cl37',8.0779647842e-06],
	['F19',9.9065e-05]])
# Material Name: Core 4
# Depletable
m9 = mcdc.material(nuclides=[
	['U235',0.00347666],
	['U238',0.0353869],
	['Cr50',8.143312100000001e-05],
	['Cr52',0.0015703566802],
	['Cr53',0.0001780658418],
	['Cr54',4.4324357e-05],
	['Ni58',0.000513745048926],
	['Ni60',0.000197893673074],
	['Ni61',8.602300946e-06],
	['Ni62',2.7427899630000002e-05],
	['Ni64',6.9850774240000005e-06],
	['Fe54',0.000392054544],
	['Fe56',0.0061544179008],
	['Fe57',0.0001421323488],
	['Fe58',1.89152064e-05],
	['C0',9.637809999999998e-05],
	['Mo100',1.167321456e-06],
	['Mo92',1.7549355510000004e-06],
	['Mo94',1.100593413e-06],
	['Mo95',1.9015695270000002e-06],
	['Mo96',1.9974087269999997e-06],
	['Mo97',1.147914018e-06],
	['Mo98',2.910157308e-06],
	['Mn55',0.000164823],
	['Cu63',1.675705035e-05],
	['Cu65',7.475849650000001e-06],
	['H1',1.9435772601288003e-05],
	['H2',3.027398712e-09],
	['Si28',6.843792728784e-05],
	['Si29',3.47508268008e-06],
	['Si30',2.2907900320799997e-06],
	['Cl35',2.5342761797099997e-05],
	['Cl37',8.1065382029e-06],
	['F19',9.94154e-05]])
mvoid = mcdc.material(nuclides=[['N14',1e-10]])
##############################
#__________Geometry__________
##############################

# Surface(s)
s1 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=40.996, bc='interface')
s2 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=65.157, bc='interface')
s3 = mcdc.surface('cylinder-z', center=[0.0, 0.0], radius=96.623, bc='vacuum')
s4 = mcdc.surface('plane-z', z=-121.92, bc='vacuum')
s5 = mcdc.surface('plane-z', z=-120.975, bc='interface')
s6 = mcdc.surface('plane-z', z=-120.461, bc='interface')
s7 = mcdc.surface('plane-z', z=-38.181, bc='interface')
s8 = mcdc.surface('plane-z', z=-22.941, bc='interface')
s9 = mcdc.surface('plane-z', z=0.0, bc='interface')
s10 = mcdc.surface('plane-z', z=22.941, bc='interface')
s11 = mcdc.surface('plane-z', z=38.181, bc='interface')
s12 = mcdc.surface('plane-z', z=120.461, bc='interface')
s13 = mcdc.surface('plane-z', z=120.975, bc='interface')
s14 = mcdc.surface('plane-z', z=121.92, bc='vacuum')

# Material Cell(s)
c1 = mcdc.cell(-s1 & +s4 & -s6, fill=m1)
c2 = mcdc.cell(+s1 & -s2 & +s4 & -s5, fill=m1)
c3 = mcdc.cell(-s1 & +s12 & -s14, fill=m1)
c4 = mcdc.cell(+s1 & -s2 & +s13 & -s14, fill=m1)
c5 = mcdc.cell(+s2 & -s3 & +s4 & -s14, fill=m2)
c6 = mcdc.cell(+s1 & -s2 & +s5 & -s13, fill=m3)
c7 = mcdc.cell(-s1 & +s6 & -s7, fill=m4)
c8 = mcdc.cell(-s1 & +s11 & -s12, fill=m5)
c9 = mcdc.cell(-s1 & +s9 & -s10, fill=m6)
c10 = mcdc.cell(-s1 & +s10 & -s11, fill=m7)
c11 = mcdc.cell(-s1 & +s8 & -s9, fill=m8)
c12 = mcdc.cell(-s1 & +s7 & -s8, fill=m9)
# Root Universe Cells List:
u0_cells = []
# Material Universe(s)

##############################
#__________Settings__________
##############################

# Simulation Parameters
mcdc.eigenmode(N_inactive=20, N_active=180)
mcdc.setting(N_particle=10000)

# Source Parameters
# Particle: neutron
# Space Type: box
mcdc.source(x=[-97.0,97.0], y=[-97.0,97.0], z=[-122.0,122.0], prob=1.0)

mcdc.run()

